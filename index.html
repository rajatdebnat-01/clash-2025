<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Creator Revenue Dashboard</title>
  <style>
    /* ===== Base Styles ===== */
    :root {
      --bg-color: #ECFBFE;
      --text-color: #134C9E;
      --card-bg: #ffffff;
      --primary: #3b82f6;
      --primary-hover: #2563eb;
      --secondary: #64748b;
      --border-color: #e2e8f0;
      --success: #10b981;
      --danger: #ef4444;
      --danger-hover: #dc2626;
      --transition: all 0.2s ease;
    }

    [data-theme="dark"] {
      --bg-color: #0f172a;
      --text-color: #f8fafc;
      --card-bg: #1e293b;
      --border-color: #334155;
      --secondary: #94a3b8;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      transition: var(--transition);
    }

    button {
      cursor: pointer;
      transition: var(--transition);
    }

    /* ===== Login Screen ===== */
    .login-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    }

    [data-theme="dark"] .login-container {
      background: linear-gradient(135deg, #0c4a6e 0%, #082f49 100%);
    }

    .login-box {
      background: var(--card-bg);
      padding: 2.5rem;
      border-radius: 12px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      width: 100%;
      max-width: 400px;
      text-align: center;
    }

    .login-box h1 {
      margin-bottom: 1.5rem;
      font-size: 1.75rem;
      font-weight: 600;
    }

    .login-box input {
      width: 100%;
      padding: 0.75rem 1rem;
      margin: 0.75rem 0;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      background-color: var(--card-bg);
      color: var(--text-color);
      transition: var(--transition);
    }

    .login-box input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }

    .login-box button {
      width: 100%;
      padding: 0.75rem;
      margin-top: 1rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
    }

    .login-box button:hover {
      background: var(--primary-hover);
    }

    /* ===== Dashboard Layout ===== */
    .dashboard-container {
      display: none;
      min-height: 100vh;
    }

    .sidebar {
      width: 240px;
      background: var(--card-bg);
      height: 100vh;
      position: fixed;
      padding: 1.5rem 1rem;
      border-right: 1px solid var(--border-color);
    }

    .sidebar h2 {
      font-size: 1.25rem;
      margin-bottom: 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-color);
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar li {
      margin-bottom: 0.5rem;
    }

    .sidebar button {
      width: 100%;
      padding: 0.75rem 1rem;
      text-align: left;
      background: transparent;
      border: none;
      border-radius: 6px;
      color: var(--text-color);
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .sidebar button:hover {
      background: rgba(59, 130, 246, 0.1);
    }

    .sidebar button.active {
      background: rgba(59, 130, 246, 0.2);
      font-weight: 500;
    }

    .main-content {
      margin-left: 240px;
      padding: 2rem;
    }

    /* ===== Sections ===== */
    .section {
      display: none;
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    }

    .section h2 {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      font-weight: 600;
    }

    /* Analytics Section */
    .chart-container {
      height: 400px;
      width: 100%;
      margin-bottom: 1.5rem;
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .metric-card {
      background: var(--card-bg);
      padding: 1.25rem;
      border-radius: 8px;
      border-left: 4px solid var(--primary);
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    }

    .metric-card h3 {
      font-size: 0.875rem;
      color: var(--secondary);
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .metric-card p {
      font-size: 1.5rem;
      font-weight: 600;
    }

    /* Date Filter */
    .date-filter {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      align-items: center;
    }

    .date-filter div {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .date-filter label {
      font-weight: 500;
      color: var(--secondary);
    }

    .date-filter input {
      padding: 0.5rem;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background: var(--card-bg);
      color: var(--text-color);
    }

    /* Content Manager */
    .content-actions {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1.5rem;
      gap: 1rem;
    }

    #search {
      flex-grow: 1;
      padding: 0.75rem 1rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--card-bg);
      color: var(--text-color);
    }

    #add-content {
      padding: 0.75rem 1.25rem;
      background: var(--success);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 500;
    }

    #add-content:hover {
      opacity: 0.9;
    }

    .content-list {
      display: grid;
      gap: 0.75rem;
    }

    .content-item {
      background: var(--card-bg);
      padding: 1rem 1.25rem;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid var(--border-color);
    }

    .content-item:hover {
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    }

    .content-item-actions {
      display: flex;
      gap: 0.5rem;
    }

    .content-item-actions button {
      padding: 0.5rem;
      border: none;
      border-radius: 6px;
      background: transparent;
    }

    .edit-btn {
      color: var(--primary);
    }

    .delete-btn {
      color: var(--danger);
    }

    .delete-btn:hover {
      background: rgba(239, 68, 68, 0.1);
    }

    /* ===== Responsive Design ===== */
    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
      }

      .main-content {
        margin-left: 0;
      }

      .date-filter {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    /* ===== Utility Classes ===== */
    .hidden {
      display: none !important;
    }

    .pagination-controls {
      display: flex;
      gap: 6px;
      margin-top: 10px;
    }

    .pagination-controls button {
      padding: 5px 10px;
      border: 1px solid #ccc;
      background: #f0f0f0;
      cursor: pointer;
    }

    .pagination-controls button.active-page {
      background-color: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }

    /* ========== Responsive Enhancements ========== */
    @media (max-width: 1024px) {
      .main-content {
        padding: 1rem;
      }

      .chart-container {
        height: 300px;
      }
    }

    @media (max-width: 768px) {
      .dashboard-container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        position: relative;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        padding: 1rem;
      }

      .main-content {
        margin-left: 0;
        padding: 1rem;
      }

      .metrics-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }

      .date-filter {
        flex-direction: column;
        align-items: flex-start;
      }

      .content-actions {
        flex-direction: column;
        align-items: stretch;
      }

      .content-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }

      .content-item-actions {
        width: 100%;
        display: flex;
        justify-content: flex-end;
        gap: 0.75rem;
      }

      canvas {
        width: 100% !important;
        height: auto !important;
      }
    }

    @media (max-width: 480px) {
      .login-box {
        padding: 1.5rem;
      }

      .login-box h1 {
        font-size: 1.5rem;
      }

      .login-box input,
      .login-box button {
        font-size: 0.95rem;
      }

      .metric-card p {
        font-size: 1.25rem;
      }
    }

    [data-layout="default"] .metrics-grid {
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    }

    [data-layout="compact"] .metrics-grid {
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    }

    [data-layout="wide"] .metrics-grid {
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    }

    .metric-card[draggable="true"] {
      cursor: grab;
      user-select: none;
    }

    .metric-card.dragging {
      opacity: 0.5;
      transform: rotate(2deg);
      background-color: #e0f2fe;
    }

    .metric-card.placeholder {
      border: 2px dashed var(--primary);
      background: rgba(59, 130, 246, 0.1);
    }

    @media (max-width: 768px) {
      .metric-card {
        touch-action: none;
      }
    }

    .metric-card {

      border-radius: 10px;
      padding: 20px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .metric-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
      cursor: grab;
    }
  </style>
</head>

<body>
  <!-- Login Screen -->
  <div class="login-container"
    style="min-height: 100vh; width: 100%; display: flex; align-items: center; justify-content: center; background-image: url('assets/bg.jpg'); background-position: center; background-repeat: no-repeat; background-size: cover; padding: 20px; box-sizing: border-box;">
    <div id="login-screen"
      style="display: flex; flex-direction: row; flex-wrap: wrap; width: 900px; max-width: 100%; background: rgba(255,255,255,0.6); border-radius: 10px; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.1);">

      <!-- Left Section -->
      <div
        style="flex: 1 1 300px; padding: 40px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: transparent; box-sizing: border-box;">
        <h2 style="color: #2b4d99; font-size: 20px; text-align: center;">Everything Social. All in One Place.</h2>
        <img src="assets/insaan_log-removebg-preview.png" alt="Illustration"
          style="width: 100%; max-width: 300px; margin-top: 20px;">
      </div>

      <!-- Right Section -->
      <div class="login-box"
        style="flex: 1 1 300px; padding: 40px; display: flex; flex-direction: column; justify-content: center; background: transparent; box-sizing: border-box;">
        <h1 style="font-size: 28px; color: #2b4d99; margin-bottom: 20px; text-align: center;">Log In</h1>

        <input type="email" id="email" placeholder="Enter your email"
          style="padding: 12px; margin: 10px 0; border: none; outline: none; width: 100%; background: #fff; border-radius: 5px; font-size: 16px; box-sizing: border-box;">

        <input type="password" id="password" placeholder="Enter password"
          style="padding: 12px; margin: 10px 0; border: none; outline: none; width: 100%; background: #fff; border-radius: 5px; font-size: 16px; box-sizing: border-box;">

        <button onclick="handleLogin()"
          style="background: #0099dd; color: #fff; padding: 12px; width: 100%; border: none; border-radius: 5px; cursor: pointer; margin: 10px 0; font-size: 16px;">Log
          In</button>

        <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 10px;">
          <label style="display: flex; align-items: center;">
            <input type="checkbox"><span style="display: flex;">
              <pre> Remember</pre>
              <pre> me</pre>
            </span>
          </label>
          <a href="#" style="align-self: center;">Forget Password?</a>
        </div>


        <div style="text-align: center; margin: 10px 0; font-size: 14px;">or,</div>
        <p style="text-align: center; font-size: 14px; margin-bottom: 8px;">Connect with us on</p>

        <div style="text-align: center;">
          <img src="assets/google.png" alt="Google" style="width: 30px; cursor: pointer;">
        </div>
      </div>
    </div>
  </div>


  <!-- Dashboard -->
  <div id="dashboard" class="dashboard-container">
    <!-- Sidebar Navigation -->
    <div class="sidebar">
      <h2>Creator Dashboard</h2>
      <ul>
        <li><button onclick="showSection('analytics')" class="active">📊 Analytics</button></li>
        <li><button onclick="showSection('content')">🎬 Content Manager</button></li>
        <li><button onclick="showSection('customization')">⚙️ Customization</button></li>
        <li><button onclick="logout()">🚪 Logout</button></li>
      </ul>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Analytics Section -->
      <div id="analytics" class="section">
        <h2>Analytics Overview</h2>

        <!-- Date Filter -->
        <div class="date-filter">
          <div>
            <label for="start-date">From:</label>
            <input type="date" id="start-date" onchange="filterData()">
          </div>
          <div>
            <label for="end-date">To:</label>
            <input type="date" id="end-date" onchange="filterData()">
          </div>
        </div>

        <div class="metrics-grid" id="metricsGrid">
          <div class="metric-card" draggable="true" data-id="0">
            <h3>Total Views</h3>
            <p id="total-views">12,456</p>
          </div>
          <div class="metric-card" draggable="true" data-id="1">
            <h3>Total Earnings</h3>
            <p id="total-earnings">$1,245</p>
          </div>
          <div class="metric-card" draggable="true" data-id="2">
            <h3>Followers</h3>
            <p id="followers">8,342</p>
          </div>
          <div class="metric-card" draggable="true" data-id="3">
            <h3>Engagement Rate</h3>
            <p id="engagement-rate">4.8%</p>
          </div>
        </div>


        <div class="chart-container">
          <canvas id="viewsChart"></canvas>
        </div>

        <div class="chart-container">
          <canvas id="earningsChart"></canvas>
        </div>

        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;">

          <div style="flex: 1 1 400px; max-width: 100%; box-sizing: border-box; padding: 10px;">
            <canvas id="followersChart" width="400" height="250"></canvas>
          </div>

          <div style="flex: 1 1 400px; max-width: 100%; box-sizing: border-box; padding: 10px;">
            <canvas id="myDonutChart" width="400" height="250"></canvas>
          </div>

        </div>

        <div
          style="display: flex; flex-direction: column; min-height: 100vh; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">

          <!-- Sidebar -->

          <!-- Main Content -->
          <div style="width: 100%; padding: 20px; background-color: #f5f5f5; color: #333; box-sizing: border-box;">
            <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px;">
              <h2 style="margin: 0;">Recent Content</h2>

            </div>

            
            <div style="height: 1px; background-color: #ecf0f1; margin: 20px 0;"></div>

            <div style="overflow-x: auto;">
              <table
                style="width: 100%; border-collapse: collapse; background-color: white; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); border-radius: 8px; overflow: hidden;">
                <thead>
                  <tr>
                    <th style="padding: 15px; text-align: left; background-color: #3498db; color: white;">Title</th>
                    <th style="padding: 15px; text-align: left; background-color: #3498db; color: white;">Status</th>
                    <th style="padding: 15px; text-align: left; background-color: #3498db; color: white;">Views</th>
                    <th style="padding: 15px; text-align: left; background-color: #3498db; color: white;">Engagement
                    </th>
                    <th style="padding: 15px; text-align: left; background-color: #3498db; color: white;">Published</th>
                    <!-- <th style="padding: 15px; text-align: left; background-color: #3498db; color: white;">Actions</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="padding: 15px;">Advanced CSS Animations</td>
                    <td style="padding: 15px; color: #2ecc71;">Published</td>
                    <td style="padding: 15px;">24.5K</td>
                    <td style="padding: 15px;">5.2%</td>
                    <td style="padding: 15px;">2 days ago</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">React Hooks Deep Dive</td>
                    <td style="padding: 15px; color: #2ecc71;">Published</td>
                    <td style="padding: 15px;">18.2K</td>
                    <td style="padding: 15px;">4.8%</td>
                    <td style="padding: 15px;">5 days ago</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                  <tr>
                    <td style="padding: 15px;">JavaScript Performance Tips</td>
                    <td style="padding: 15px; color: #e74c3c;">Draft</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <td style="padding: 15px;">—</td>
                    <!-- <td style="padding: 15px; color: #3498db; cursor: pointer;">Edit</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>



      </div>



      <!-- Content Manager Section -->
      <div id="content" class="section" style="display:none">
        <h2>Content Manager</h2>

        <div class="content-actions">
          <input type="text" id="search" placeholder="Search content...">
          <!-- <button id="add-content" onclick="addContent()">+ Add Content</button> -->
        </div>

        <div id="content-list" class="content-list"></div>
        <div id="pagination" class="pagination-controls" style="margin-top: 15px;"></div>



      </div>

      <div id="customization" class="section" style="display: none;">
        <h2>Customization Panel</h2>

        <div style="margin-bottom: 1.5rem;">
          <h3 style="margin-bottom: 0.5rem;">Theme</h3>
          <button onclick="toggleTheme()"
            style="padding: 0.5rem 1rem; background-color: #134C9E; color: white; border: none; border-radius: 5px;">🌙
            Toggle Theme</button>
        </div>
        <!-- 
        <div style="margin-bottom: 1.5rem;">
          <h3 style="margin-bottom: 0.5rem;">Widget Layout</h3>
          <label>
            <input type="radio" name="layout" checked onchange="setLayout('default')"> Default Layout
          </label>
          <br>
          <label>
            <input type="radio" name="layout" onchange="setLayout('compact')"> Compact Layout
          </label>
          <br>
          <label>
            <input type="radio" name="layout" onchange="setLayout('wide')"> Wide Layout
          </label>
        </div> -->

        <div style="margin-bottom: 1rem;">
          <h3 style="margin-bottom: 0.5rem;">Widget Rearrangement</h3>
          <label>
            <input type="checkbox" id="toggleReorder"> Enable Widget Rearrangement
          </label>
        </div>
      </div>


    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/auth.js" defer></script>
  <script>
    // ===== Mock Data =====
    const mockContent = [
      { id: 1, title: "How to Build a Website", thumbnail: "thumb1.jpg", views: 1200, earnings: 85, date: "2023-05-15" },
      { id: 2, title: "CSS Animations Tutorial", thumbnail: "thumb2.jpg", views: 3400, earnings: 210, date: "2023-06-02" },
      { id: 3, title: "JavaScript Fundamentals", thumbnail: "thumb3.jpg", views: 5600, earnings: 320, date: "2023-06-18" },

    ];

    const mockAnalytics = {
      labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
      dates: [
        "2023-01-01", "2023-02-01", "2023-03-01",
        "2023-04-01", "2023-05-01", "2023-06-01"
      ],
      views: [3200, 2800, 4000, 5200, 7800, 9500],
      earnings: [180, 150, 220, 310, 450, 580],
      followers: [5200, 5800, 6400, 7100, 7800, 8342]
    };

    // ===== DOM Elements =====
    let currentPage = 1;
    const itemsPerPage = 5;

    const loginScreen = document.querySelector(".login-container");
    const dashboard = document.getElementById("dashboard");
    const contentList = document.getElementById("content-list");
    const searchInput = document.getElementById("search");

    // Chart instances
    let viewsChart, earningsChart;
    let followersChart;




    function logout() {
      localStorage.removeItem("user");
      window.location.reload();
    }

    // Check if user is already logged in
    if (localStorage.getItem("user")) {
      loginScreen.style.display = "none";
      dashboard.style.display = "block";
      renderContent();
      initCharts();
      updateMetrics();
      showSection('analytics'); // Show analytics by default
    }

    // ===== Content Management =====
    function renderContent() {
      const searchTerm = searchInput.value.toLowerCase();
      const filteredContent = mockContent.filter(item =>
        item.title.toLowerCase().includes(searchTerm)
      );

      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const paginatedContent = filteredContent.slice(startIndex, endIndex);

      contentList.innerHTML = paginatedContent.map(item => `
    <div class="content-item" data-id="${item.id}">
      <div>
        <strong>${item.title}</strong>
        <div class="text-sm" style="color: var(--secondary)">
          ${new Date(item.date).toLocaleDateString()} • ${item.views.toLocaleString()} views • $${item.earnings}
        </div>
      </div>
      <div class="content-item-actions">
        <button class="edit-btn" onclick="editContent(${item.id})">✏️</button>
        <button class="delete-btn" onclick="deleteContent(${item.id})">🗑️</button>
      </div>
    </div>
  `).join("");

      renderPagination(filteredContent.length);
    }
    function renderPagination(totalItems) {
      const paginationContainer = document.getElementById("pagination");
      const totalPages = Math.ceil(totalItems / itemsPerPage);

      let buttonsHTML = "";

      for (let i = 1; i <= totalPages; i++) {
        buttonsHTML += `
      <button onclick="goToPage(${i})" ${i === currentPage ? 'class="active-page"' : ''}>${i}</button>
    `;
      }

      paginationContainer.innerHTML = buttonsHTML;
    }

    function goToPage(pageNumber) {
      currentPage = pageNumber;
      renderContent();
    }


    function addContent() {
      const title = prompt("Enter content title:");
      if (title) {
        const newContent = {
          id: mockContent.length + 1,
          title: title,
          thumbnail: "thumb-new.jpg",
          views: Math.floor(Math.random() * 5000),
          earnings: Math.floor(Math.random() * 300),
          date: new Date().toISOString().split('T')[0]
        };
        mockContent.unshift(newContent);
        renderContent();
      }
    }

    function editContent(id) {
      const item = mockContent.find(item => item.id === id);
      if (item) {
        const newTitle = prompt("Edit content title:", item.title);
        if (newTitle) {
          item.title = newTitle;
          renderContent();
        }
      }
    }

    function deleteContent(id) {
      if (confirm("Are you sure you want to delete this content?")) {
        const index = mockContent.findIndex(item => item.id === id);
        if (index !== -1) {
          mockContent.splice(index, 1);
          renderContent();
        }
      }
    }

    // Search functionality
    searchInput.addEventListener("input", renderContent);

    // ===== Analytics =====
    function initCharts() {
      const viewsCtx = document.getElementById("viewsChart").getContext("2d");
      const earningsCtx = document.getElementById("earningsChart").getContext("2d");
      const followersCtx = document.getElementById("followersChart").getContext("2d");

      viewsChart = new Chart(viewsCtx, {
        type: "line",
        data: getlineChartData(),
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            tooltip: { mode: "index", intersect: false }
          },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });

      earningsChart = new Chart(earningsCtx, {
        type: "bar",
        data: getChartData(),
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });

      // Pie chart for followers
      followersChart = new Chart(followersCtx, {
        type: "pie",
        data: {
          labels: mockAnalytics.labels,
          datasets: [{
            data: mockAnalytics.followers,
            backgroundColor: [
              "#3b82f6", "#16a34a", "#f59e0b", "#ef4444", "#8b5cf6", "#0ea5e9"
            ]
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'right'
            }
          }
        }
      });

      // Set default dates (last 3 months)
      const endDate = new Date(mockAnalytics.dates[mockAnalytics.dates.length - 1]);
      const startDate = new Date(endDate);
      startDate.setMonth(startDate.getMonth() - 2);

      document.getElementById("start-date").valueAsDate = startDate;
      document.getElementById("end-date").valueAsDate = endDate;
    }


    function getChartData(filteredData) {
      const data = filteredData || mockAnalytics;
      return {
        labels: data.labels,
        datasets: [
          {
            label: "Views",
            data: data.views,
            borderColor: "#3b82f6",
            backgroundColor: "rgba(59, 130, 246, 0.1)",
            borderWidth: 2,
            tension: 0.3,
            fill: true
          },

        ]
      };
    }

    function getlineChartData(filteredData) {
      const data = filteredData || mockAnalytics;
      return {
        labels: data.labels,
        datasets: [
          {
            label: "Earnings ($)",
            data: data.earnings,
            backgroundColor: "rgba(16, 185, 129, 0.3)", // light green fill
            borderColor: "rgba(16, 185, 129, 1)",       // green line
            borderWidth: 2,
            fill: true, // fill under the line
            tension: 0.4 // smooth curves
            // no need to add type: "line" here unless mixed chart is being used
          }
        ]
      };
    }



    function filterData() {
      const startDate = document.getElementById("start-date").value;
      const endDate = document.getElementById("end-date").value;

      if (!startDate || !endDate) return;

      // Filter data based on date range
      const filteredData = {
        labels: [],
        dates: [],
        views: [],
        earnings: [],
        followers: []
      };

      for (let i = 0; i < mockAnalytics.dates.length; i++) {
        const currentDate = mockAnalytics.dates[i];
        if (currentDate >= startDate && currentDate <= endDate) {
          filteredData.labels.push(mockAnalytics.labels[i]);
          filteredData.dates.push(mockAnalytics.dates[i]);
          filteredData.views.push(mockAnalytics.views[i]);
          filteredData.earnings.push(mockAnalytics.earnings[i]);
          filteredData.followers.push(mockAnalytics.followers[i]);
        }
      }

      // Update charts with filtered data
      viewsChart.data = getChartData(filteredData);
      viewsChart.update();

      earningsChart.data = getChartData(filteredData);
      earningsChart.update();

      followersChart.data = {
        labels: filteredData.labels,
        datasets: [{
          data: filteredData.followers,
          backgroundColor: [
            "#3b82f6", "#16a34a", "#f59e0b", "#ef4444", "#8b5cf6", "#0ea5e9"
          ]
        }]
      };
      followersChart.update();


      // Update metrics
      updateMetrics(filteredData);
    }

    function updateMetrics(data = mockAnalytics) {
      document.getElementById("total-views").textContent =
        data.views.reduce((a, b) => a + b, 0).toLocaleString();
      document.getElementById("total-earnings").textContent =
        "$" + data.earnings.reduce((a, b) => a + b, 0);
      document.getElementById("followers").textContent =
        data.followers.length > 0
          ? data.followers[data.followers.length - 1].toLocaleString()
          : "0";

      // Calculate engagement rate (mock calculation)
      const engagementRate = (data.views.reduce((a, b) => a + b, 0) / 100000 * 4.8).toFixed(1);
      document.getElementById("engagement-rate").textContent = engagementRate + "%";
    }

    // ===== UI Functions =====
    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll(".section").forEach(section => {
        section.style.display = "none";
      });

      // Show selected section
      const section = document.getElementById(sectionId);
      if (section) section.style.display = "block";

      // Update active state in sidebar
      document.querySelectorAll(".sidebar button").forEach(btn => {
        btn.classList.remove("active");
      });

      // Find the button that matches this section and make it active
      const activeBtn = Array.from(document.querySelectorAll(".sidebar button")).find(btn =>
        btn.getAttribute("onclick")?.includes(sectionId)
      );
      if (activeBtn) activeBtn.classList.add("active");
    }

    function toggleTheme() {
      const html = document.documentElement;
      const newTheme = html.dataset.theme === "light" ? "dark" : "light";
      html.dataset.theme = newTheme;
      localStorage.setItem("theme", newTheme);
    }

    // Check for saved theme preference
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme) {
      document.documentElement.dataset.theme = savedTheme;
    }


    function setLayout(type) {
      const root = document.documentElement;
      root.dataset.layout = type;
      localStorage.setItem("layout", type);
    }

    // Load saved layout preference on load
    const savedLayout = localStorage.getItem("layout");
    if (savedLayout) {
      document.documentElement.dataset.layout = savedLayout;
    }


    const grid = document.getElementById("metricsGrid");

    let draggedItem = null;



    function saveWidgetOrder() {
      const order = Array.from(document.querySelectorAll(".metric-card")).map(card => card.dataset.id);
      localStorage.setItem("widgetOrder", JSON.stringify(order));
    }


    function loadWidgetOrder() {
      const savedOrder = JSON.parse(localStorage.getItem("widgetOrder"));
      if (!savedOrder) return;

      const grid = document.getElementById("metricsGrid");
      const cards = Array.from(grid.children);
      savedOrder.forEach(id => {
        const card = cards.find(c => c.dataset.id === id);
        if (card) grid.appendChild(card);
      });
    }


    // Initialize on load
    window.addEventListener("DOMContentLoaded", () => {
      loadWidgetOrder();
      if (document.getElementById("toggleReorder").checked) {
        enableWidgetRearrangement(); // 👍 load if toggle is ON
      }
    });

    // === Drag & Drop Widget Rearrangement ===
    let isReorderEnabled = false;

    document.getElementById("toggleReorder").addEventListener("change", function (e) {
      isReorderEnabled = e.target.checked;
      const metricCards = document.querySelectorAll(".metric-card");

      metricCards.forEach(card => {
        card.setAttribute("draggable", isReorderEnabled);
        card.style.cursor = isReorderEnabled ? "move" : "default";
      });

      if (isReorderEnabled) {
        enableWidgetRearrangement();
      } else {
        disableWidgetRearrangement();
      }
    });
    function enableWidgetRearrangement() {
      const grid = document.getElementById("metricsGrid");
      let draggingEle;
      let placeholder;
      let isDraggingStarted = false;
      let x = 0;
      let y = 0;

      const mouseDownHandler = function (e) {
        draggingEle = e.currentTarget;
        const rect = draggingEle.getBoundingClientRect();
        x = e.pageX - rect.left;
        y = e.pageY - rect.top;

        // Clone a placeholder
        placeholder = document.createElement("div");
        placeholder.classList.add("metric-card");
        placeholder.style.height = `${rect.height}px`;
        placeholder.style.background = "#e2e8f0";
        draggingEle.parentNode.insertBefore(placeholder, draggingEle.nextSibling);

        draggingEle.style.position = "fixed"; // More stable across layouts
        draggingEle.style.width = `${placeholder.offsetWidth}px`;
        draggingEle.style.zIndex = "1000";
        draggingEle.style.pointerEvents = "none";

        document.addEventListener("mousemove", mouseMoveHandler);
        document.addEventListener("mouseup", mouseUpHandler);
      };

      const mouseMoveHandler = function (e) {
        const grid = document.getElementById("metricsGrid");
        if (!isDraggingStarted) {
          isDraggingStarted = true;
        }

        draggingEle.style.left = `${e.pageX - x}px`;
        draggingEle.style.top = `${e.pageY - y}px`;

        const prevEle = placeholder.previousElementSibling;
        const nextEle = placeholder.nextElementSibling;

        const draggingRect = draggingEle.getBoundingClientRect();

        if (prevEle && prevEle !== draggingEle) {
          const prevRect = prevEle.getBoundingClientRect();
          if (draggingRect.top < prevRect.top + prevRect.height / 2) {
            grid.insertBefore(placeholder, prevEle);
          }
        }

        if (nextEle && nextEle !== draggingEle) {
          const nextRect = nextEle.getBoundingClientRect();
          if (draggingRect.top > nextRect.top + nextRect.height / 2) {
            grid.insertBefore(placeholder, nextEle.nextSibling);
          }
        }
      };

      const mouseUpHandler = function () {
        placeholder.parentNode.insertBefore(draggingEle, placeholder);
        draggingEle.style.removeProperty("top");
        draggingEle.style.removeProperty("left");
        draggingEle.style.removeProperty("position");
        draggingEle.style.removeProperty("z-index");
        draggingEle.style.removeProperty("pointer-events");

        placeholder.remove();

        document.removeEventListener("mousemove", mouseMoveHandler);
        document.removeEventListener("mouseup", mouseUpHandler);

        // Save widget order
        saveWidgetOrder();
        isDraggingStarted = false;
      };

      document.querySelectorAll(".metric-card").forEach(card => {
        card.style.cursor = "move";
        card.addEventListener("mousedown", mouseDownHandler);
      });
    }



    function disableWidgetRearrangement() {
      const cards = document.querySelectorAll(".metric-card");

      cards.forEach(card => {
        card.setAttribute("draggable", "false");
        card.style.cursor = "default";

        const clone = card.cloneNode(true); // remove all old listeners
        card.parentNode.replaceChild(clone, card);
      });
    }


    const ctx = document.getElementById('myDonutChart').getContext('2d');

    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['June 25', 'June 26', 'June 27', 'June 28'],
        datasets: [{
          label: 'Engagement by Date',
          data: [20, 35, 15, 30],
          backgroundColor: ['#4CAF50', '#2196F3', '#FF9800', '#E91E63'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        cutout: '70%',
        plugins: {
          legend: {
            position: 'bottom'
          },
          tooltip: {
            callbacks: {
              label: function (context) {
                return `${context.label}: ${context.parsed}%`;
              }
            }
          }
        }
      }
    });
  </script>
</body>

</html>